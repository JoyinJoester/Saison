# 课程表图片识别导入功能

## 🎯 功能概述

新增了课程表图片识别导入功能，支持以下三种导入方式：
1. **图片识别导入** - 使用 AI OCR 技术识别课程表图片
2. **CSV 文件导入** - 导入标准格式的 CSV 课程数据
3. **ICS 日历导入** - 导入 iCalendar 格式的课程表（原有功能）

## 📱 使用方法

### 图片识别导入

1. 点击课程页面右上角的**导入按钮**（下载图标）
2. 在弹出菜单中选择 **"图片识别导入"**
3. 从相册或文件管理器选择课程表图片
4. 系统自动识别课程信息（课程名、星期、节次、地点、教师）
5. 在预览页面中可以：
   - **编辑课程信息** - 点击课程卡片展开编辑
   - **添加课程** - 点击"添加课程"按钮
   - **删除课程** - 点击删除图标
6. 点击 **"导入 X 门课程"** 完成导入
7. 可选：点击 **"创建新学期并导入"** 将课程添加到新学期

### CSV 文件导入

1. 准备 CSV 文件，格式如下：
   ```csv
   课程名称,星期,起始节次,结束节次,地点,教师,开始日期,结束日期
   高等数学,周一,1,2,A101,张三,2024-09-01,2025-01-15
   大学英语,周二,3,4,B202,李四,2024-09-01,2025-01-15
   ```

2. 点击导入按钮，选择 **"CSV 文件导入"**
3. 选择 CSV 文件
4. 系统自动解析并导入课程

#### CSV 格式说明

- **必填字段**：课程名称、星期、起始节次、结束节次
- **可选字段**：地点、教师、开始日期、结束日期
- **星期格式**：支持 `周一`、`星期一`、`一`、`1`、`Mon` 等格式
- **日期格式**：`yyyy-MM-dd`（如：2024-09-01）

## 🎨 Material 3 设计特性

### 动画效果
- ✅ 导入菜单的下拉动画
- ✅ 识别进度指示器的淡入/淡出
- ✅ 课程卡片的展开/收起动画
- ✅ 预览列表的滚动动画

### 视觉反馈
- ✅ 识别中的加载指示器
- ✅ 错误消息的醒目提示
- ✅ 导入成功的 Snackbar 提示
- ✅ 卡片点击的涟漪效果

## 🔧 技术实现

### 核心组件

1. **CourseTableOcrParser** - OCR 识别和解析
   - 使用 Google ML Kit Text Recognition
   - 支持中文课程表识别
   - 智能解析课程名、星期、节次、地点、教师

2. **CourseCsvParser** - CSV 解析
   - 支持标准 CSV 格式
   - 灵活的日期和星期格式
   - 错误处理和验证

3. **CourseImageImportSheet** - 图片导入预览页面
   - Material 3 ModalBottomSheet
   - 可编辑的课程列表
   - 实时预览和调整

4. **CreateSemesterForImportDialog** - 新学期创建对话框
   - 学期名称、开始日期、总周数设置
   - 与导入流程无缝集成

### 导入流程

```
用户点击导入 
  ↓
显示导入菜单（图片/CSV/ICS）
  ↓
[图片导入] → 图片选择 → OCR识别 → 解析课程 → 预览调整 → 导入
[CSV导入]  → 文件选择 → CSV解析 → 直接导入
[ICS导入]  → 文件选择 → ICS解析 → 导入预览 → 导入
```

## 📝 注意事项

1. **图片质量**：
   - 建议使用清晰、光线充足的课程表图片
   - 避免模糊、倾斜或反光
   - 支持手机拍照和截图

2. **识别准确性**：
   - OCR 识别可能不是 100% 准确
   - 导入前请在预览页面仔细检查
   - 可手动编辑修正错误

3. **学期管理**：
   - 导入默认添加到当前学期
   - 可选择创建新学期避免课程冲突
   - 建议每学期开始时创建新学期

## 🚀 未来改进

- [ ] 支持表格结构识别（网格识别）
- [ ] 批量导入多张图片
- [ ] 导出课程为 CSV/图片
- [ ] 识别结果的置信度显示
- [ ] 支持更多课程表格式

## 🐛 已知问题

无

## 📄 相关文件

- `CourseScreen.kt` - 主界面和导入按钮
- `CourseImageImportSheet.kt` - 图片导入预览UI
- `CourseTableOcrParser.kt` - OCR识别工具
- `CourseCsvParser.kt` - CSV解析工具
- `CreateSemesterForImportDialog.kt` - 新学期创建对话框
- `CourseViewModel.kt` - 批量导入逻辑

---

**版本**: 1.1.0
**更新日期**: 2025-01-12
